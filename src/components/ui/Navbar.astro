---
import { Image } from 'astro:assets'
import { profile, NAV_LINKS, template } from '@/settings'
import SocialIcons from './SocialIcons.astro'
import ProfilePictures from '@/assets/profile_pictures.jpg'

const { fullName, title } = profile
---
<aside
	class='px-4 pt-4 h-screen w-[20rem] bg-base-200 text-base-content flex flex-col sticky top-0 navbar-sidebar'
>
	<div class='flex flex-col justify-between h-full overflow-y-auto scrollbar-hide'>
		<div class='flex-shrink-0'>
			<div class='flex justify-center items-center flex-col'>
				<Image
					class='mask mask-circle size-32'
					src={ProfilePictures}
					alt={`Profile picture of ${fullName}`}
				/>
				<div class="text-center mt-4 hidden lg:block">
					<h1 class="text-xl font-bold mb-1">{fullName}</h1>
					<p class="text-base text-base-content/70 leading-tight px-2">{title}</p>
					<button 
						id="copy-email-btn"
						class="text-sm text-base-content/60 hover:text-primary mt-1 cursor-pointer transition-colors"
						title="Click to copy email"
					>
						zl788@cornell.edu
					</button>
				</div>
			</div>
			<div class='mx-4 mt-8'>
				<ul class='space-y-4 menu grow shrink menu-md overflow-y-auto'>
					{NAV_LINKS.map((link) => (
						<li>
							<a 
								href={`${template.base}${link.href}`} 
								class={link.title === 'AI Integration' 
									? 'text-lg text-[#4A7C8C] hover:text-[#5A8C9C]' 
									: 'text-lg'}
							>
								{link.title}
							</a>
						</li>
					))}
				</ul>
			</div>
		</div>
		<div class='mx-4 mb-8 mt-auto pt-8 flex-shrink-0'>
			<SocialIcons/>
		</div>
	</div>
</aside>

<style>
	/* Hide scrollbar while keeping scroll functionality */
	.scrollbar-hide {
		-ms-overflow-style: none;  /* IE and Edge */
		scrollbar-width: none;  /* Firefox */
	}
	
	.scrollbar-hide::-webkit-scrollbar {
		display: none;  /* Chrome, Safari, Opera */
	}
	
	.navbar-sidebar {
		overflow-y: auto;
		-ms-overflow-style: none;
		scrollbar-width: none;
	}
	
	.navbar-sidebar::-webkit-scrollbar {
		display: none;
	}
</style>

<script is:inline>
	document.addEventListener('DOMContentLoaded', () => {
		const copyEmailBtn = document.getElementById('copy-email-btn');
		if (copyEmailBtn) {
			copyEmailBtn.addEventListener('click', async () => {
				const email = 'zl788@cornell.edu';
				try {
					await navigator.clipboard.writeText(email);
					const originalText = copyEmailBtn.textContent;
					copyEmailBtn.textContent = 'Copied!';
					copyEmailBtn.classList.add('text-success');
					setTimeout(() => {
						copyEmailBtn.textContent = originalText;
						copyEmailBtn.classList.remove('text-success');
					}, 2000);
				} catch (err) {
					console.error('Failed to copy email:', err);
				}
			});
		}
	});
</script>
